(()=>{document.addEventListener("DOMContentLoaded",()=>{let i=document.querySelector("z-toc");if(!i)return;let L=i.getAttribute("data-toc")==="true",p=parseInt(i.getAttribute("data-toc-level")||"2",10);if(!L)return;let y=document.getElementById("blog-content");if(!y)return;let b=!!document.querySelector("z-fn"),x=!!document.querySelector("z-cite"),A=document.querySelector("z-bibliography")?.getAttribute("src"),w=["h1","h2","h3","h4","h5","h6"].slice(0,p),E=y.querySelectorAll(w.join(","));if(E.length===0&&!b&&!x)return;let c=[],h=Array.from({length:p},()=>[]),S=(e,n)=>{let t=e.id||e.textContent.trim().toLowerCase().replace(/\s+/g,"-");return e.id=t,{title:e.textContent.trim(),id:t,level:n,children:[]}};if(E.forEach(e=>{let n=e.tagName.toLowerCase(),t=w.indexOf(n)+1,o=S(e,t);if(t===1)c.push(o),h[0].push(o);else{let v=t-1,u=h[v-1],m=u[u.length-1];m&&m.children.push(o);for(let r=t;r<p;r++)h[r]=[];h[t-1].push(o)}}),b&&c.push({title:"Footnotes",id:"footnotes",level:1,children:[]}),x&&A&&c.push({title:"References",id:"references",level:1,children:[]}),c.length===0)return;let T=e=>e.join("."),C=(e,n)=>{let t=e.level-1,o=T(n),v=e.children&&e.children.length>0,u=t===0?"-mx-2 px-2":`pl-${(t+1)*3} pr-2`,m=t===0?"w-5":"w-7",r=`
        <div class="space-y-0.5">
          <a href="#${e.id}" class="block py-0.5 rounded transition-colors relative group hover:bg-gray-50">
            <div class="flex items-center gap-2 ${u}">
              <span class="text-xs font-medium text-gray-400 group-hover:text-gray-600 transition-colors ${m}">
                ${o}
              </span>
              <span class="text-xs text-gray-700 group-hover:text-gray-900 transition-colors ${t===0?"font-medium":""}">
                ${e.title}
              </span>
            </div>
          </a>
      `;if(v){let $=t===0?"bg-gray-200 top-0 bottom-0":"bg-gray-100 top-1 bottom-1";r+=`
          <div class="relative ${t>0?"ml-3":"ml-6"}">
            <div class="absolute left-0 w-px ${$}"></div>
            <div class="space-y-0.5">
        `,e.children.forEach((H,N)=>{r+=C(H,[...n,N+1])}),r+="</div></div>"}return r+="</div>",r},l=document.createElement("nav");l.className="mb-8 relative",l.setAttribute("role","navigation"),l.setAttribute("aria-label","Table of contents");let g=!1,a=document.createElement("div");a.className=`
      relative border rounded-lg overflow-hidden transition-all duration-300 bg-gray-50
      border-gray-100 hover:shadow
    `.trim().replace(/\s+/g," ");let d=document.createElement("button");d.className="w-full px-4 py-2 transition-all duration-200",d.innerHTML=`
      <div class="flex items-center justify-between">
        <h3 class="text-sm font-medium text-gray-900">Table of Contents</h3>
        <i data-lucide="chevron-down" class="w-4 h-4 text-gray-400 transition-transform duration-300"></i>
      </div>
    `,a.appendChild(d);let s=document.createElement("div");s.className="transition-all duration-300 ease-in-out overflow-hidden bg-white max-h-0 opacity-0";let f=document.createElement("div");f.className="px-4 pb-3 pt-1 space-y-1",s.appendChild(f),a.appendChild(s),c.forEach((e,n)=>{f.innerHTML+=C(e,[n+1])}),d.addEventListener("click",()=>{g=!g;let e=d.querySelector('[data-lucide="chevron-down"]');g?(s.style.maxHeight=s.scrollHeight+"px",s.style.opacity="1",a.classList.remove("hover:shadow"),a.classList.add("border-gray-200"),e&&(e.style.transform="rotate(180deg)")):(s.style.maxHeight="0px",s.style.opacity="0",a.classList.add("border-gray-200"),e&&(e.style.transform="rotate(0deg)"))}),l.appendChild(a),i.appendChild(l),lucide.createIcons({el:l}),i.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();let t=e.getAttribute("href").substring(1),o=document.getElementById(t);o&&window.scrollTo({top:o.offsetTop-100,behavior:"smooth"})})})});})();
