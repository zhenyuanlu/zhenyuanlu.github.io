---
layout: default
---

{% capture stripped_content %}{{ content | strip_html | strip_newlines }}{% endcapture %}
{% assign word_count = stripped_content | split:' ' | size %}
{% assign read_time = word_count | divided_by:200 %}
{% if read_time == 0 %}{% assign read_time = 1 %}{% endif %}

{% assign icons = site.data.resource_icons %}
{% assign icon_set = site.icon_set | default: 'lucide' %}

<div x-cloak 
     class="min-h-screen" 
     :class="darkMode ? 'bg-gray-950' : 'bg-white'"
     x-data="{ 
       openShare: false, 
       showShareToast: false, 
       showBibtex: false,
       currentBibtex: '',
       copied: false,
       activeCitation: null,
       activeFootnote: null,
       showSideNotes: true,
       isMobileView: window.innerWidth < 1024
     }">


  <!-- Main Content -->
  <div class="max-w-3xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
    <!-- Header Section -->
    <section class="space-y-6 mb-12">
      <!-- Navigation -->
      <nav aria-label="Breadcrumb" class="flex items-center space-x-2 text-sm">
        <div class="flex items-center">
          <a href="/" class="text-gray-600 hover:text-gray-900"
            :class="darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'">
            Home
          </a>
        </div>

        <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i>

        <div class="flex items-center">
          <a href="/{{ page.collection }}" class="text-gray-600 hover:text-gray-900"
            :class="darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'">
            {{ page.collection | capitalize }}
          </a>
        </div>

        <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i>

        <div class="flex items-center">
          <span class="italic" :class="darkMode ? 'text-gray-300' : 'text-gray-700'">
            Current Page
          </span>
        </div>
      </nav>

      <div class="space-y-6">
        <h1 class="text-4xl font-bold leading-tight" :class="darkMode ? 'text-white' : 'text-gray-900'">
          {{ page.title }}
        </h1>

        <!-- Container for tags and share menu -->
        <div class="relative w-full">
          <div class="flex flex-wrap gap-2 pr-16">
            {% if page.tags %}
            {% for topic in page.tags %}
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm transition-colors"
              :class="darkMode ? 'bg-blue-900/40 text-blue-300 ring-1 ring-blue-700' : 'bg-blue-50 text-blue-700'">
              <i data-lucide="tag" class="w-3 h-3 mr-1.5 opacity-50"></i>
              {{ topic }}
            </span>
            {% endfor %}
            {% endif %}
          </div>

          <div class="absolute top-0 right-0">
            {% include shared/share_menu.html %}
          </div>
        </div>

        <!-- Author and Metadata -->
        <div class="flex flex-wrap items-center gap-4">
          <div class="flex flex-wrap items-center gap-x-6 gap-y-2 text-sm"
            :class="darkMode ? 'text-gray-400' : 'text-gray-600'">
            {% if page.author %}
            <div class="font-medium" :class="darkMode ? 'text-white' : 'text-gray-900'">
              {{ page.author }}
            </div>
            {% endif %}

            <div class="flex items-center gap-1.5">
              <i data-lucide="calendar" class="w-4 h-4"></i>
              <span>Published {{ page.date | date: "%b %d, %Y" }}</span>
              {% if page.last_modified_at %}
              <span class="mx-2">â€¢</span>
              <span>Updated {{ page.last_modified_at | date: "%b %d, %Y" }}</span>
              {% endif %}
            </div>

            <div class="flex items-center gap-1.5">
              <i data-lucide="clock" class="w-4 h-4"></i>
              <span>{{ read_time }} min read</span>
            </div>
          </div>
        </div>

        <!-- Resources -->
        {% if page.links %}
        <div class="flex flex-wrap gap-2 mt-4">
          {% for resource_type in page.links %}
          {% assign rtype = resource_type.type %}
          {% assign link = resource_type.href %}
          {% assign this_icon = icons[rtype] %}
          {% if icon_set == 'fontawesome' %}
            {% assign icon_class = this_icon.fontawesome %}
            {% capture resource_icon %}<i class="{{ icon_class }}"></i>{% endcapture %}
          {% else %}
            {% assign icon_class = this_icon.lucide %}
            {% capture resource_icon %}<i data-lucide="{{ icon_class }}" class="w-4 h-4"></i>{% endcapture %}
          {% endif %}

          {% if rtype == "bibtex" %}
            <button @click="showBibtex = true; currentBibtex = `{{ link }}`; copied = false;"
              class="inline-flex items-center px-3 py-1.5 rounded-lg text-sm gap-1.5 transition-colors group"
              :class="darkMode ? 'bg-blue-950 text-blue-300 hover:bg-blue-900' : 'bg-blue-50 text-blue-700 hover:bg-blue-100'">
              {{ resource_icon }}
              cite
            </button>
          {% else %}
            <a href="{{ link }}"
              class="inline-flex items-center px-3 py-1.5 rounded-lg text-sm gap-1.5 transition-colors group"
              :class="darkMode ? 'bg-blue-950 text-blue-300 hover:bg-blue-900' : 'bg-blue-50 text-blue-700 hover:bg-blue-100'"
              target="_blank" rel="noopener noreferrer">
              {{ resource_icon }}
              {{ rtype }}
            </a>
          {% endif %}
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </section>

    <!-- Main Article -->
    <article class="relative">
      {% if page.image %}
      <div class="relative aspect-video mb-8 rounded-xl overflow-hidden"
        :class="darkMode ? 'bg-gray-800' : 'bg-gray-100'">
        <img src="{{ page.image | relative_url }}" alt="{{ page.title }}" class="w-full h-full object-cover" />
      </div>
      {% endif %}

      <!-- Abstract -->
      {% if page.description %}
      <div class="mb-12">
        <h2 class="text-xl font-semibold mb-4" :class="darkMode ? 'text-white' : 'text-gray-900'">
          Abstract
        </h2>
        <p class="leading-relaxed" :class="darkMode ? 'text-gray-300' : 'text-gray-600'">
          {{ page.description }}
        </p>
      </div>
      <div class="border-t border-gray-200 dark:border-gray-800 my-12"></div>
      {% endif %}
  
      <!-- Main Content -->
      <div class="prose prose-lg prose-headings:font-semibold max-w-none pb-12 relative"
           :class="darkMode ? 'dark:prose-invert dark:prose-a:text-blue-400' : 'prose-a:text-blue-600'">
        {{ content }}
      </div>

      <!-- Bibliography -->
      {% if page.bibliography %}
      <div class="border-t border-gray-200 dark:border-gray-800 my-12"></div>
      <section>
        <h2 class="text-xl font-semibold mb-6" :class="darkMode ? 'text-white' : 'text-gray-900'">
          Bibliography
        </h2>
        <div class="space-y-4">
          {% for ref in page.bibliography %}
            <z-ref>{{ ref }}</z-ref>
          {% endfor %}
        </div>
      </section>
      {% endif %}

      <!-- Footnotes -->
      {% if page.footnotes %}
      <div class="border-t border-gray-200 dark:border-gray-800 my-12"></div>
      <section>
        <h2 class="text-xl font-semibold mb-6" :class="darkMode ? 'text-white' : 'text-gray-900'">
          Footnotes
        </h2>
        <div class="space-y-4">
          {% for note in page.footnotes %}
            <div class="flex gap-2">
              <span>{{ forloop.index }}.</span>
              <z-footnote>{{ note }}</z-footnote>
            </div>
          {% endfor %}
        </div>
      </section>
      {% endif %}
    </article>
  </div>

  <!-- Citation Preview -->
  <template x-if="activeCitation">
    <div class="fixed top-1/2 right-8 transform -translate-y-1/2 w-64 p-4 
                bg-white dark:bg-gray-900 shadow-xl rounded-lg 
                border border-gray-200 dark:border-gray-800">
      <z-cite-preview :id="activeCitation"></z-cite-preview>
    </div>
  </template>

  <!-- Footnote Preview -->
  <template x-if="activeFootnote">
    <div class="fixed bottom-8 right-8 w-64 p-4 
                bg-white dark:bg-gray-900 shadow-xl rounded-lg 
                border border-gray-200 dark:border-gray-800">
      <z-footnote-preview :id="activeFootnote"></z-footnote-preview>
    </div>
  </template>

  {% include shared/bibtex_modal.html %}
</div>